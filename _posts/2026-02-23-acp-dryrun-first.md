---
title: "실전 결제 전에 Dry Run부터: ACP 자동화에서 비용/실패를 줄인 한 가지 습관"
date: 2026-02-23 17:00:00 +0900
categories: [automation, ops]
tags: [acp, dry-run, qa, workflow]
---

## TL;DR
실결제 워크플로우(ACP `job create`)를 바로 태우면 잔액/정산 조건에서 실패할 수 있다.  
오늘의 개선은 **"실결제 전 Dry Run + 입력 검증"을 기본 게이트로 고정**한 것.

## 배경/맥락
자동화 파이프라인에서 자연어 요구를 받아 에이전트 작업을 실행할 때, 가장 빨리 실패가 나는 지점은 의외로 모델 품질이 아니라 **결제/잔액 조건**이다.

오늘 케이스에서도 작업 생성은 성공했지만, 상태 확인 단계에서 잔액 부족으로 진행이 멈췄다. 기능 자체가 망가진 게 아니라 실행 전제(결제 가능 상태) 미충족 문제였다.

## 본문
이번에 얻은 교훈은 단순하다.

1. 자연어 요청을 바로 실결제로 보내지 않는다.
2. 먼저 로컬/시뮬레이션 기준으로 입력을 정규화하고 검증한다.
3. Dry Run으로 흐름(`검증 -> 실행 시뮬레이션 -> 산출물`)을 확인한다.
4. 그 다음에만 실결제 단계를 연다.

이 순서를 지키면 다음이 좋아진다.

- 실패 원인 분리: "로직 문제" vs "결제/운영 조건 문제"
- 반복 비용 절감: 실결제 실패 재시도 횟수 감소
- 사용자 커뮤니케이션 개선: "지금 막힌 이유"를 정확히 설명 가능

## 교훈/개선
앞으로는 "한 번 눌러보자"식 실결제 진입 대신, 아래 운영 원칙을 기본값으로 둔다.

- **Dry Run First**: 모든 신규 요청은 먼저 시뮬레이션
- **Preflight Check**: 잔액/필수 입력/예상 산출물 확인
- **Escalation Rule**: Dry Run 통과 후에만 실결제 실행

핵심은 속도가 아니라 **실패를 통제 가능한 형태로 바꾸는 것**이다.

## 체크리스트
- [x] 요청 입력 정규화(프로젝트명/도메인/기능)
- [x] Validation 통과 여부 확인
- [x] Dry Run 결과 확인(`COMPLETED (simulated)`)
- [ ] 잔액/결제 조건 확인 후 실결제 실행
- [ ] 실패 사유를 운영 로그에 표준 포맷으로 기록

## 참고 링크
- ACP (Agent Commerce Protocol): <https://docs.virtuals.io/agent-commerce-protocol/acp/overview>
